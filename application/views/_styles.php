<?php if (isset($styles) && isset($service)) : ?>
    <section id="Styles">
        <div>
            <div class="wrp bot-mrgn-med">
                <div class="w-1">
                    <h5 class="about__title"><?php echo $service['select_heading']; ?>:</h5>
                </div>
            </div>
            <div class="grd">
                <?php if ($service['need_help']) : ?>
                    <div class="question col cntr">
                        <h6 class="bot-mrgn-ult">?</h6>
                        <h5 class="bot-mrgn-ult"><b>Я не знаю,</b> что мне подойдет</h5>
                        <a class="btn" popup-trigger="need-help">Зато мы знаем, рассказать?</a>
                    </div>
                <?php endif; ?>
                <?php $counter = 0; ?>
                <?php foreach ($styles as $key => $style) : ?>
                    <a href="<?= base_url() . ($salon['slug'] !== 'default' ? $salon['slug'] . '/' : '') . $service['slug'] . '/' . $style['slug'] ?>"
                       popup-trigger="style-<?php echo $style['slug']; ?>" class="item <?php echo $style['size']; ?> <?php echo $style['position']; ?>"
                       style="background-image: url(<?php echo base_url(); ?>media/styles/<?php echo $style['slug']; ?>/preview_big.jpg);">
                        <h4 style="text-align: center"><?php echo $style['name_short']; ?></h4>
                    </a>
                <?php endforeach; ?>
            </div>
    </section>

    <?php if ($service['need_help']) : ?>
        <div class="cs-popup info-popup" trigger="need-help">
            <div class="wrp">
                <div class="w-1 row jsfd">
                    <div class="w-8-12 no-mrgn text">
                        <h5 class="salon__popup-title bot-mrgn-ult"><?php echo isset($need_help_block) && array_key_exists('title', $need_help_block) ? $need_help_block['title'] : '';?></h5>
                        <p class="bot-mrgn-ult"><?php echo isset($need_help_block) && array_key_exists('text', $need_help_block) ? $need_help_block['text'] : '';?></p>
                        <?php $this->load->view('_form', array('horizontal' => false, 'heading' => '<strong>Запишись онлайн:</strong>', 'master' => false)); ?>
                    </div>
                    <div class="w-4-12 no-mrgn img" style="background-image: url(<?php echo base_url(); ?>assets/imgs/popup_about-atmosphere.jpg);"></div>
                </div>
            </div>
        </div>
    <?php endif; ?>

    <?php foreach ($styles as $style) : ?>
        <div class="cs-popup style-popup" trigger="style-<?php echo $style['slug']; ?>">
            <div class="wrp">
                <div class="w-1 header"
                     style="background-image: url(<?php echo base_url(); ?>media/styles/<?php echo $style['slug']; ?>/popup.jpg);">
                    <h3><?php echo $style['name']; ?></h3>
                </div>
                <div class="w-1 row mobile-row jsfd cntr-itms body">
                    <div class="w-7-12 mobile text">
                        <p class="bot-mrgn-sml"><?php echo $style['description']; ?></p>
                        <div class="w-1 row cntr-itms bot-mrgn-ult">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 410.39 410.29">
                                <path d="M60,410.29c-7-2.07-14.32-3.35-20.87-6.36C13.26,392-2.27,364.52,1.12,337.7c3.78-29.89,24.19-52.42,53-58.24a62,62,0,0,1,34.23,2.48c2.73,1,4.4.82,6.55-1.35,20.93-21.12,42-42.07,62.94-63.2,1.26-1.27,1.87-3.6,2-5.49.3-4.09.09-8.22.09-12.94-4,0-7.88.43-11.62-.14-2.83-.43-6.16-1.43-8.1-3.35Q72,127.64,4.13,59.43A12.32,12.32,0,0,1,.94,51.71C.63,37.45.76,23.18.81,8.92.82,3.09,3.24.75,9.16.71c7.2,0,14.4.15,21.6-.07a12.49,12.49,0,0,1,9.9,4.1q47.84,48,95.84,95.92,28.28,28.28,56.51,56.62a7.81,7.81,0,0,0,7.38,2.45,42.57,42.57,0,0,1,10.72.05,7.45,7.45,0,0,0,7-2.47q75.85-76,151.78-152c3.26-3.27,6.6-4.93,11.27-4.71,6.65.31,13.33.24,20,0,4.15-.13,7.28,1.09,9.23,4.85v50.4c-1.23,1.36-2.4,2.77-3.69,4.07Q339.15,127.52,271.62,195.1A12,12,0,0,1,262,199c-3.52-.16-7.06,0-10.83,0,0,4.79-.22,8.92.1,13a9.26,9.26,0,0,0,2.1,5.48c21,21.2,42.17,42.25,63.22,63.41,1.72,1.73,3.08,2.23,5.5,1.38,32.78-11.49,67.39,2.87,82,34.38,3,6.53,4.25,13.9,6.31,20.88v13.6a14.94,14.94,0,0,0-.73,2.25c-3.79,23.76-16.59,40.91-38.34,51-6.29,2.91-13.4,4-20.14,6h-13.6a19.77,19.77,0,0,0-2.65-.76,65.78,65.78,0,0,1-52.73-87.21c.88-2.47.63-4-1.29-5.87-21.19-21-42.24-42.22-63.46-63.23-1.27-1.25-3.61-1.82-5.51-2a102.61,102.61,0,0,0-12.72,0c-1.79.1-4,.53-5.22,1.69-21.41,21.2-42.66,42.55-64,63.8-1.67,1.66-1.92,3-1.15,5.2,11.56,33.15-3.1,67.95-35.06,82.41-6.33,2.86-13.44,4-20.19,5.93ZM397.1,342.79c-.14-1.52-.21-4.48-.73-7.35C390.15,301,355,282.27,322.84,296.05c-5.87,2.51-7.32,2.27-11.69-2.1q-35.22-35.19-70.47-70.35c-3-3-4.3-6-3.18-10.32,2.57-10,.37-19.22-5.61-27.61-9.05-12.7-27.66-16.84-41.93-9.26-14,7.46-21,25.18-15.56,39.69,6.09,16.33,21,24.84,38.09,21.38,4.85-1,8.24.07,11.73,3.6C247.37,264.5,270.72,287.72,294,311c4.43,4.43,4.71,5.86,2.17,11.67a52.71,52.71,0,0,0,50,74.25C375,395.66,397.13,372.71,397.1,342.79ZM229,164.44c5,5,10.67,8.74,13.47,14,3.79,7.1,9,7.64,15.6,7.29,3-.16,5.16-.81,7.34-3Q329.9,118,394.51,53.38A8.84,8.84,0,0,0,397,48c.24-10.26.13-20.53.1-30.79a27.35,27.35,0,0,0-.41-3.23c-4.29,0-8.29.2-12.26-.06-3.22-.21-5.42,1-7.66,3.21Q304.49,89.57,232,161.9A38,38,0,0,1,229,164.44ZM28.93,35.08,41.19,23.71c-2.49-2.39-4.64-4.54-6.89-6.58-1.25-1.14-2.61-2.9-4-3C25,13.78,19.73,14,14.06,14c0,12.21-.05,23.91.09,35.61,0,1.11,1.06,2.39,1.95,3.27q65.28,65.38,130.64,130.68c.74.74,1.62,1.84,2.47,1.87,4.66.19,9.44.71,13.93-.18,1.86-.37,3.07-4,4.59-6.09a11.91,11.91,0,0,1,1.24-1.56c4.3-4.25,8.61-8.47,12.6-12.4l-12.74-13-10.56,11.42-10.57-9.65,11.72-10.32L148.14,132l-10.31,11.27-10.12-9.05,11.92-10.28L129.1,112.27,118.4,123.9l-10.47-9.73,12.49-10.77-11.09-11L98.86,104.53,88.33,94.45l11.49-10.5L89,72.31,78.2,84.24l-9.77-9.44,12-10.44L69.13,52.79,58.47,64.52l-9.54-9.2L60.7,44.53,49.75,33,38.58,44.75ZM164.84,229.23c-.63.6-1.69,1.58-2.7,2.59l-61.92,61.93c-4.62,4.62-5.93,4.89-12,2.25a53.79,53.79,0,0,0-26.9-4.28c-29.3,2.72-50.83,30.13-46.84,59.76,3.93,29.19,32.2,50,60.94,44.88,34.4-6.14,53.42-41.33,39.68-73.4-2.68-6.26-2.46-7.42,2.42-12.3l61.92-61.93c1-1,1.89-2,2.32-2.52Z"/>
                                <path d="M344.48,304.66A39.93,39.93,0,0,1,384,344.49c-.12,21.59-18.34,39.53-40,39.37s-39.36-18.31-39.22-40.1C304.89,322.32,322.91,304.59,344.48,304.66Zm-.08,65.88a26.37,26.37,0,0,0,0-52.74c-14.34-.14-26.52,12-26.53,26.41A26.46,26.46,0,0,0,344.41,370.54Z"/>
                                <path d="M225.42,205.35a19.83,19.83,0,1,1-20.08-19.68C216,185.44,225.29,194.55,225.42,205.35ZM205.77,199a6.46,6.46,0,1,0,6.28,6.73A6.36,6.36,0,0,0,205.77,199Z"/>
                                <path d="M67.07,304.66c21.64.06,39.48,18.15,39.35,39.91-.13,21.46-18.12,39.31-39.6,39.3s-39.66-18.14-39.6-39.76S45.33,304.6,67.07,304.66ZM40.54,344.31a26.37,26.37,0,0,0,52.74,0c.14-14.34-12-26.52-26.41-26.53A26.46,26.46,0,0,0,40.54,344.31Z"/>
                            </svg>
                            <p><b>Продолжительность:</b> <?php echo $style['time']; ?> мин.</p>
                        </div>
                        <div class="w-1 row cntr-itms bot-mrgn-sml">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 411.2 410.4">
                                <path d="M193.6,410.4c-7.09-1-14.22-1.9-21.28-3.12a187.7,187.7,0,0,1-85.15-38.07C54.66,343.62,32.81,310.72,21.3,271a174.81,174.81,0,0,1-7.11-51.27c.25-17.7,0-35.53,2-53.07,4.08-36.1,18.62-68.16,41.85-96C87,35.83,123.59,12.87,168.23,4.72c71.47-13,132.24,7.81,181.15,61.49,25.12,27.57,39.75,60.57,45.56,97.4,3.07,19.45,2.27,39.09,2,58.67a186.81,186.81,0,0,1-30.14,100.4c-19.51,30.37-45.88,53-78.32,68.66a188.6,188.6,0,0,1-68.22,18.39,15.72,15.72,0,0,0-2.67.67ZM27.05,192.81c0,98.29,80.34,178.33,178.94,178.29,98.16,0,177.94-79.8,178.16-178.11.22-98.57-79.64-179-178-179.24C107.59,13.48,27,94,27.05,192.81ZM364.22,300.32c-39.63,53.64-91.48,83-157.46,83.3C141,383.93,88.74,355.47,49,303.4c21.47,44.1,77.19,93,155.11,93.88C275.21,398.07,337.27,355.56,364.22,300.32Z"/>
                                <path d="M205.56,45.89c81.74.62,146.64,66.09,146.7,146.85S286.91,338.88,205.84,339.37C125.36,339.86,59.05,273.91,59,192.82,58.86,112.49,123.39,46.6,205.56,45.89Zm.61,280.58c73.94-.73,133.54-60.66,133.21-133.95C339,118.6,278.77,58.47,205.43,58.9c-74.15.43-134.61,61.23-133.61,134.36C72.84,267.63,132.9,327.19,206.17,326.47Z"/>
                                <path d="M187.51,206.26v11.1H192c11.86,0,23.72,0,35.58,0,3.58,0,6.27,1.48,6.89,5.28.57,3.48-.89,6-4.34,7.06a17,17,0,0,1-4.72.53c-11.06,0-22.12,0-33.18,0h-4.92c0,2.09,0,3.9,0,5.71,0,8.93,0,17.86,0,26.78,0,4.45-2.51,7.3-6.18,7.43s-6.6-2.9-6.64-7.45c-.08-10.64,0-21.28,0-32.47-2.73,0-5.21.07-7.68,0-4.73-.17-7.56-2.64-7.57-6.48s2.77-6.26,7.54-6.4c2.38-.07,4.76,0,7.42,0V206.26c-2.24,0-4.57,0-6.9,0-5.08-.11-8-2.45-8.05-6.4s2.81-6.37,7.86-6.48c2.25,0,4.5,0,7.19,0,.08-1.65.19-3,.19-4.44q0-32.18,0-64.36c0-7.24,2.09-9.43,9.21-9.34,10.38.13,20.89-.59,31.11.83,23.49,3.26,39.08,24.57,37.23,49.4a44.23,44.23,0,0,1-44,40.8C201.25,206.33,194.49,206.26,187.51,206.26Zm0-12.47c9.61-.49,19.19.09,28.3-1.71,12.33-2.44,19.64-11.37,22.44-23.42s-.22-22.74-8.94-31.58c-12-12.15-27.24-8.48-41.8-9Z"/>
                            </svg>
                            <p><b>Стоимость от:</b> <?php echo $style['price']; ?> руб.</p>
                        </div>
                        <?php $this->load->view('_form', array('slug_style' => $style['slug'], 'master' => false)); ?>
                    </div>
                    <?php
                    $files_string = 'media/styles/' . $style['slug'] . '/gallery/';
                    if (file_exists($files_string)) : ?>
                        <div class="w-5-12 mobile js-style-slider swiper">
                            <div class="content swiper-wrapper">
                                <?php $files = glob('./media/styles/' . $style['slug'] . '/gallery/*.jpg');
                                $imgs = [];
                                foreach ($files as $file) {
                                    $imgs[] = str_replace(['./', '.jpg'], '', $file);
                                }
                                foreach ($imgs as $img) : ?>
                                    <div class="slide swiper-slide">
                                        <picture>
                                            <source type="image/webp" data-srcset="<?= base_url() . $img . '.webp' ?>" class="swiper-lazy">
                                            <img alt="<?= $style['name']; ?>" data-src="<?= base_url() . $img . '.jpg' ?>" class="swiper-lazy">
                                        </picture>
                                    </div>
                                <?php endforeach; ?>
                            </div>
                            <button class="style__gallery-next gallery-next" type="button"></button>
                            <button class="style__gallery-prev gallery-prev" type="button"></button>
                        </div>
                    <?php endif; ?>
                </div>
            </div>
        </div>
    <?php endforeach; ?>
<?php endif; ?>
